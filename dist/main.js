window.AudioEditor=function(e){var t={};function s(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);class n{constructor(){this.DISABLED_BTN_CLASS="mvaudio__btn-disabled",this.CONSOLE_PREFIX="Audio Editor :: "}setDisabled(e){$(e).addClass(this.DISABLED_BTN_CLASS)}setEnabled(e){$(e).removeClass(this.DISABLED_BTN_CLASS)}bindOnMousePressed(e,t){let s,n=0;function a(){n++,t()}$(e).bind("mousedown",()=>{n=0,s=setInterval(a,30)}),$(e).bind("mouseup",()=>{0===n&&t(),clearInterval(s)})}printToConsole(e,t){console[e](this.CONSOLE_PREFIX+t)}log(e){this.printToConsole("log",e)}warning(e){this.printToConsole("warn",e)}error(e){this.printToConsole("error",e)}}class a{constructor(e){this.context=e,this.WAV_HEADER_SIZE=44}copyAudioBuffer(e){let t=e.sampleRate,s=this.context.createBuffer(1,e.duration*t,t);return s.getChannelData(0).set(e.getChannelData(0),0),s}convertArrayBufferToBlob(e){return new Blob([e],{type:"audio/wav"})}partOfbufferToWave(e){let t,s=e.numberOfChannels,n=e.length*s*2,a=new ArrayBuffer(n),i=new DataView(a),r=[],l=0,o=0;for(let t=0;t<e.numberOfChannels;t++)r.push(e.getChannelData(t));for(;o<n;){for(let e=0;e<s;e++){t=Math.max(-1,Math.min(1,r[e][l])),t=0|(.5+t<0?32768*t:32767*t);try{i.setInt16(o,t,!0)}catch(e){}o+=2}l++}return a}bufferToWave(e,t){let s,n=e.numberOfChannels,a=t*n*2+this.WAV_HEADER_SIZE,i=new ArrayBuffer(a),r=new DataView(i),l=[],o=0,h=0;d(1179011410),d(a-8),d(1163280727),d(544501094),d(16),u(1),u(n),d(e.sampleRate),d(2*e.sampleRate*n),u(2*n),u(16),d(1635017060),d(a-h-4);for(let t=0;t<e.numberOfChannels;t++)l.push(e.getChannelData(t));for(;h<a;){for(let e=0;e<n;e++){s=Math.max(-1,Math.min(1,l[e][o])),s=0|(.5+s<0?32768*s:32767*s);try{r.setInt16(h,s,!0)}catch(e){}h+=2}o++}return i;function u(e){r.setUint16(h,e,!0),h+=2}function d(e){r.setUint32(h,e,!0),h+=4}}float32Concat(e,t){let s=e.length,n=new Float32Array(s+t.length);return n.set(e),n.set(t,s),n}float32Copy(e){let t=new Float32Array(e.length);return t.set(e),t}arrayBufferConcat(e,t){let s=new Uint8Array(e.byteLength+t.byteLength);return s.set(new Uint8Array(e),0),s.set(new Uint8Array(t),e.byteLength),s.buffer}extractDelta(e){return e.originalEvent.deltaY?e.originalEvent.deltaY:e.wheelDelta?e.wheelDelta:e.originalEvent.detail?40*e.originalEvent.detail:e.originalEvent&&e.originalEvent.wheelDelta?e.originalEvent.wheelDelta:0}getFormattedDuration(e){let t=Math.floor(e/3600%60),s=Math.floor(e/60%60),n=Math.round(e%60),a=[t,t>0&&s<10?"0"+s:s,n<10?"0"+n:n].filter(Boolean).join(":");return{duration:e,hours:t,minutes:s,seconds:n,formatted:a}}}class i{constructor(e){this.context=e,this.HelperInstance=new a(e),this.blob=window.URL||window.webkitURL}updateLastBufferWithNew(e,t,s,n,a,i){let r=Math.floor(a-n),l=t.slice(0,2*n+this.HelperInstance.WAV_HEADER_SIZE),o=t.slice(2*a+this.HelperInstance.WAV_HEADER_SIZE,t.byteLength),h=e.createBuffer(1,r,i),u=s.getChannelData(0).slice(n,a);h.copyToChannel(u,0,0);let d=this.HelperInstance.partOfbufferToWave(h);return this.HelperInstance.arrayBufferConcat(this.HelperInstance.arrayBufferConcat(l,d),o)}deleteInterval(e,t,s,n,a){let i=t.sampleRate,r=Math.floor(s*i),l=Math.floor(n*i),o=l-r,h=e.createBuffer(1,t.length-o,i),u=t.getChannelData(0),d=this.HelperInstance.float32Concat(u.slice(0,r),u.slice(l,t.length));h.copyToChannel(d,0,0);let c=this.HelperInstance.arrayBufferConcat(a.slice(0,2*r+this.HelperInstance.WAV_HEADER_SIZE),a.slice(2*l+this.HelperInstance.WAV_HEADER_SIZE,a.byteLength));return{start:r,end:l,lastArrayBuffer:c,fileURL:this.blob.createObjectURL(this.HelperInstance.convertArrayBufferToBlob(c)),updatedBuffer:h}}beepInterval(e,t,s,n,a){let i=t.sampleRate,r=Math.floor(s*i),l=Math.floor(n*i),o=t,h=t.getChannelData(0),u=0,d=.002;for(let e=r;e<l;e++)(u>=.02||u<=-.02)&&(d*=-1),u+=d,h[e]=u;o.copyToChannel(h,0,0);let c=this.updateLastBufferWithNew(e,a,o,r,l,i);return{start:r,end:l,lastArrayBuffer:c,fileURL:this.blob.createObjectURL(this.HelperInstance.convertArrayBufferToBlob(c)),updatedBuffer:o}}fadeInInterval(e,t,s,n,a){let i=t.sampleRate,r=Math.floor(s*i),l=Math.floor(n*i),o=t,h=t.getChannelData(0),u=0,d=1/Math.ceil(l-r);for(let e=r;e<l;e++)u++,h[e]=h[e]*(u*d);o.copyToChannel(h,0,0);let c=this.updateLastBufferWithNew(e,a,o,r,l,i);return{start:r,end:l,lastArrayBuffer:c,fileURL:this.blob.createObjectURL(this.HelperInstance.convertArrayBufferToBlob(c)),updatedBuffer:o}}fadeOutInterval(e,t,s,n,a){let i=t.sampleRate,r=Math.floor(s*i),l=Math.floor(n*i),o=t,h=t.getChannelData(0),u=0,d=1/Math.ceil(l-r);for(let e=l;e>r;e--)u++,h[e]=h[e]*(u*d);o.copyToChannel(h,0,0);let c=this.updateLastBufferWithNew(e,a,o,r,l,i);return{start:r,end:l,lastArrayBuffer:c,fileURL:this.blob.createObjectURL(this.HelperInstance.convertArrayBufferToBlob(c)),updatedBuffer:o}}changeVolumeInterval(e,t,s,n,a,i){let r=t.sampleRate,l=Math.floor(s*r),o=Math.floor(n*r),h=t,u=t.getChannelData(0);for(let e=l;e<o;e++)u[e]=u[e]*a;h.copyToChannel(u,0,0);let d=this.updateLastBufferWithNew(e,i,h,l,o,r);return{start:l,end:o,lastArrayBuffer:d,fileURL:this.blob.createObjectURL(this.HelperInstance.convertArrayBufferToBlob(d)),updatedBuffer:h}}}t.default=class{constructor(e){this.duration=e,this.context=new(window.AudioContext||window.webkitAudioContext),this.SEEK_STEP=5,this.UNDO_SNAPSHOTS_MAX_COUNT=1,this.KEYS={SPACE:32,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,A:65},this.COLOR={POINT:"#18bce0",SELECTION:"#f44b42",WAVEFORM_ZOOM:"#87c442",WAVEFORM_OVERVIEW:"#bbb"},this.WAVEFORM_CONTAINER="#mvaudio__waveform-container",this.WAVEFORM_CONTAINER_ELEMENT=document.querySelector(this.WAVEFORM_CONTAINER),this.soundBuffer=null,this.ZOOM_SECOND_MULTIPLIER=24,this.BufferUtilsInstance=new i(this.context),this.HelperInstance=new a(this.context),this.UIHelperInstance=new n,this.peaksInstance,this.callbacks={},this.currentPixelOffset=null,this.msgElement=document.querySelector("#mvaudio__message"),this.mediaElement=document.querySelector("#mvaudio__audio-element"),this.loader=$("#mvaudio__loader"),this.volumeSliderValue=0,this.soundBufferSnapshots=[],this.lastStart=null,this.lastEnd=null,this.lastArrayBuffer=null,this.lastDuration=null,this.zoomLevels=[],this.initZoomLevels(this.duration),this.centerZoomIndex=Math.floor((this.zoomLevels.length-1)/2),this.setLoading(!0),this.initPeaks(0,{initialZoom:this.centerZoomIndex}),this.initButtonListeners(),this.initKeyListeners(),this.initMouseWheelListener(),this.initVolumeSlider(),this.initMouseClickListener()}initPeaks(e,t){this.peaksInstance&&this.peaksInstance.destroy(),this.peaksInstance=peaks.init({containers:{zoomview:this.WAVEFORM_CONTAINER_ELEMENT},mediaElement:this.mediaElement,audioContext:this.context,zoomLevels:this.zoomLevels,zoomWaveformColor:this.COLOR.WAVEFORM_ZOOM,overviewWaveformColor:this.COLOR.WAVEFORM_OVERVIEW,preparedAudioBuffer:this.soundBuffer,lastStart:this.lastStart,lastEnd:this.lastEnd,isDelete:t.isDelete||!1}),this.peaksInstance.on("peaks.ready",()=>{this.soundBuffer=this.peaksInstance._audioBuffer,this.lastArrayBuffer&&!t.isUndo||(this.lastArrayBuffer=this.HelperInstance.bufferToWave(this.soundBuffer,this.soundBuffer.duration*this.soundBuffer.sampleRate)),this.updateUI(),this.peaksInstance.zoom.setZoom(t.initialZoom),e&&this.peaksInstance.player.seek(e),this.currentPixelOffset&&this.peaksInstance.emit("user_scroll.zoomview",this.currentPixelOffset),this.lastDuration!=this.soundBuffer.duration&&(this.notifyChangeDuration(this.HelperInstance.getFormattedDuration(this.soundBuffer.duration)),this.lastDuration=this.soundBuffer.duration),this.setLoading(!1),this.hideCanvasSnapshot()}),this.peaksInstance.on("points.add",()=>{this.updateUI()}),this.peaksInstance.on("points.remove",()=>{this.updateUI()}),this.peaksInstance.on("points.remove_all",()=>{this.updateUI()}),this.peaksInstance.on("points.dragmove",()=>{this.updateSelection()}),this.peaksInstance.on("user_scroll.zoomview",e=>{this.currentPixelOffset=e})}initButtonListeners(){$("#mvaudio__controls").show(),$("#mvaudio__btn-seek-forward").on("click",()=>this.seekForward()),$("#mvaudio__btn-seek-backward").on("click",()=>this.seekBackward()),$("#mvaudio__btn-play").on("click",()=>this.play()),$("#mvaudio__btn-pause").on("click",()=>this.pause()),$("#mvaudio__btn-add-point").on("click",()=>this.addPoint()),$("#mvaudio__btn-select-all").on("click",()=>this.selectAll()),$("#mvaudio__btn-remove-points").on("click",()=>this.removePoints()),$("#mvaudio__btn-delete").on("click",()=>this.deleteSelection()),$("#mvaudio__btn-change-volume").on("click",()=>this.changeVolumeSelection()),$("#mvaudio__btn-beep").on("click",()=>this.beepSelection()),$("#mvaudio__btn-fade-in").on("click",()=>this.fadeInSelection()),$("#mvaudio__btn-fade-out").on("click",()=>this.fadeOutSelection()),$("#mvaudio__btn-undo").on("click",()=>this.undo()),$("#mvaudio__btn-save").on("click",()=>this.save()),this.UIHelperInstance.bindOnMousePressed("#mvaudio__btn-zoom-in",this.zoomIn),this.UIHelperInstance.bindOnMousePressed("#mvaudio__btn-zoom-out",this.zoomOut),this.updateUI()}initKeyListeners(){$(document).keydown(e=>{switch(e.which){case this.KEYS.SPACE:this.peaksInstance.player._isPlaying?this.pause():this.play();break;case this.KEYS.ARROW_LEFT:this.seekBackward();break;case this.KEYS.ARROW_RIGHT:this.seekForward();break;case this.KEYS.A:1==e.ctrlKey&&this.selectAll();break;default:return}e.preventDefault()})}initMouseWheelListener(){let e=0;$(this.WAVEFORM_CONTAINER).on("mousewheel DOMMouseScroll",t=>{t.originalEvent.ctrlKey&&(t.preventDefault(),e+=this.HelperInstance.extractDelta(t),e>50?(this.zoomOut(),e=0):e<-50&&(this.zoomIn(),e=0))})}initMouseClickListener(){$(this.WAVEFORM_CONTAINER).on("dblclick",e=>{this.addPoint(),e.preventDefault()})}initVolumeSlider(){$("#mvaudio__volume-slider").slider({min:-5,max:5,step:1,values:[0],slide:(e,t)=>{let s="";0!=t.value?(s+=Math.abs(t.value)+" krát ",s+=t.value>0?"hlasitější":"tlumenější"):s="&nbsp;",$("#mvaudio__volume-slider-value").html(s),this.volumeSliderValue=t.value}})}initZoomLevels(e){if(!e||e<1)return void(this.zoomLevels=[50,100,200,400,800,1600]);this.zoomLevels=[];let t=Math.floor(e*this.ZOOM_SECOND_MULTIPLIER),s=100,n=1.5,a=0;for(;s<t;)if(this.zoomLevels.push(s),s=Math.floor(s*n),n>1.1&&(n=Math.round(100*(n-.05))/100),a++,a>=1e4){console.log("initZoomLevels - reach limit");break}}updateUI(){this.UIHelperInstance.setDisabled("#mvaudio__btn-play"),this.UIHelperInstance.setDisabled("#mvaudio__btn-pause"),this.UIHelperInstance.setDisabled("#mvaudio__btn-seek-backward"),this.UIHelperInstance.setDisabled("#mvaudio__btn-seek-forward"),this.UIHelperInstance.setDisabled("#mvaudio__btn-zoom-in"),this.UIHelperInstance.setDisabled("#mvaudio__btn-zoom-out"),this.UIHelperInstance.setDisabled("#mvaudio__btn-add-point"),this.UIHelperInstance.setDisabled("#mvaudio__btn-select-all"),this.UIHelperInstance.setDisabled("#mvaudio__btn-remove-points"),this.UIHelperInstance.setDisabled("#mvaudio__btn-delete"),this.UIHelperInstance.setDisabled("#mvaudio__btn-change-volume"),this.UIHelperInstance.setDisabled("#mvaudio__change-volume-slider"),this.UIHelperInstance.setDisabled("#mvaudio__btn-beep"),this.UIHelperInstance.setDisabled("#mvaudio__btn-fade-in"),this.UIHelperInstance.setDisabled("#mvaudio__btn-fade-out"),this.UIHelperInstance.setDisabled("#mvaudio__btn-undo"),this.UIHelperInstance.setDisabled("#mvaudio__btn-save");let e=this.soundBuffer&&this.soundBuffer.numberOfChannels||null;if(e)if(1==e){this.UIHelperInstance.setEnabled("#mvaudio__btn-play"),this.UIHelperInstance.setEnabled("#mvaudio__btn-pause"),this.UIHelperInstance.setEnabled("#mvaudio__btn-seek-backward"),this.UIHelperInstance.setEnabled("#mvaudio__btn-seek-forward"),this.UIHelperInstance.setEnabled("#mvaudio__btn-zoom-in"),this.UIHelperInstance.setEnabled("#mvaudio__btn-zoom-out"),this.UIHelperInstance.setEnabled("#mvaudio__btn-add-point"),this.UIHelperInstance.setEnabled("#mvaudio__btn-select-all"),this.UIHelperInstance.setEnabled("#mvaudio__btn-remove-points"),this.UIHelperInstance.setEnabled("#mvaudio__btn-save");let e=this.peaksInstance.points.getPoints();e&&e.length>=1?this.UIHelperInstance.setEnabled("#mvaudio__btn-remove-points"):this.UIHelperInstance.setDisabled("#mvaudio__btn-remove-points"),e&&e.length&&2==e.length?(this.UIHelperInstance.setEnabled("#mvaudio__btn-delete"),this.UIHelperInstance.setEnabled("#mvaudio__btn-change-volume"),this.UIHelperInstance.setEnabled("#mvaudio__change-volume-slider"),this.UIHelperInstance.setEnabled("#mvaudio__btn-beep"),this.UIHelperInstance.setEnabled("#mvaudio__btn-fade-in"),this.UIHelperInstance.setEnabled("#mvaudio__btn-fade-out")):(this.UIHelperInstance.setDisabled("#mvaudio__btn-delete"),this.UIHelperInstance.setDisabled("#mvaudio__btn-change-volume"),this.UIHelperInstance.setDisabled("#mvaudio__change-volume-slider"),this.UIHelperInstance.setDisabled("#mvaudio__btn-beep"),this.UIHelperInstance.setDisabled("#mvaudio__btn-fade-in"),this.UIHelperInstance.setDisabled("#mvaudio__btn-fade-out")),this.soundBufferSnapshots.length>0?this.UIHelperInstance.setEnabled("#mvaudio__btn-undo"):this.UIHelperInstance.setDisabled("#mvaudio__btn-undo"),this.clearMessage()}else this.showMessage("Tato nahrávka není Mono (obsahuje více zvukových kanálů), tudíž ji nelze upravovat.")}showMessage(e){this.msgElement.innerHTML=e}clearMessage(){this.msgElement.innerHTML=""}setLoading(e){e?this.loader.show():this.loader.hide()}getSelectedInterval(){let e,t,s=this.peaksInstance.points.getPoints();return!(!s||!s.length||2!=s.length)&&(s[0].time<s[1].time?(e=s[0].time,t=s[1].time):(e=s[1].time,t=s[0].time),e<0?e=0:e>this.duration-1&&(e=this.duration-1),t>this.duration&&(t=this.duration),{start:e,end:t})}updateSelection(){this.peaksInstance.segments.removeAll();let e=this.getSelectedInterval();e&&e.start!=e.end&&this.peaksInstance.segments.add({startTime:e.start,endTime:e.end,color:this.COLOR.SELECTION})}removeFirstPointFromCurrentSelection(){let e=this.peaksInstance.points.getPoints();e&&e.length&&2==e.length&&this.peaksInstance.points.removeById(e[0].id)}zoomOut(){this.peaksInstance.zoom.zoomOut()}zoomIn(){this.peaksInstance.zoom.zoomIn()}seekForward(){this.mediaElement.currentTime=this.mediaElement.currentTime+this.SEEK_STEP}seekBackward(){this.mediaElement.currentTime=this.mediaElement.currentTime-this.SEEK_STEP}play(){this.peaksInstance.player.play()}pause(){this.peaksInstance.player.pause()}selectAll(){this.removePoints(),this.peaksInstance.points.add({time:0,editable:!0,color:this.COLOR.POINT},{time:Math.floor(this.peaksInstance.player.getDuration()),editable:!0,color:this.COLOR.POINT}),this.updateSelection()}addPoint(){this.removeFirstPointFromCurrentSelection(),this.peaksInstance.points.add({time:this.peaksInstance.player.getCurrentTime(),editable:!0,color:this.COLOR.POINT}),this.updateSelection()}removePoints(){this.peaksInstance.segments.removeAll(),this.peaksInstance.points.removeAll()}showCanvasSnapshot(){return new Promise((e,t)=>{let s=window.scrollY,n=document.querySelector(this.WAVEFORM_CONTAINER);html2canvas(n,{height:n.clientHeight+s,logging:!1}).then(t=>{$(this.WAVEFORM_CONTAINER).css("background-image","url("+t.toDataURL()+")"),$(this.WAVEFORM_CONTAINER).css("background-position-y",-1*s),e()})})}hideCanvasSnapshot(){$(this.WAVEFORM_CONTAINER).css("background-image","none")}updateCurrentAudio(e,t,s,n,a){if(!n&&(this.soundBufferSnapshots.push({fileURL:this.mediaElement.src,time:s}),this.soundBufferSnapshots.length>this.UNDO_SNAPSHOTS_MAX_COUNT)){let e=this.soundBufferSnapshots.shift();URL.revokeObjectURL(e.fileURL)}this.soundBuffer=e,this.mediaElement.src=t;let i={initialZoom:this.peaksInstance.zoom.getZoom()};a&&(i.isDelete=!0),n&&(i.isUndo=!0),setTimeout(()=>{this.initPeaks(s,i)},0)}deleteSelection(){this.getSelectedInterval()&&(this.setLoading(!0),this.showCanvasSnapshot().then(()=>{let e=this.getSelectedInterval();if(e){let t=this.BufferUtilsInstance.deleteInterval(this.context,this.soundBuffer,e.start,e.end,this.lastArrayBuffer),s=this.mediaElement.currentTime;s>e.end?s-=e.end-e.start:s>e.start&&s<e.end&&(s=e.start),this.lastStart=t.start,this.lastEnd=t.end,this.lastArrayBuffer=t.lastArrayBuffer,this.updateCurrentAudio(t.updatedBuffer,t.fileURL,s,!1,!0)}}))}beepSelection(){let e=this.getSelectedInterval();e&&(this.setLoading(!0),this.showCanvasSnapshot().then(()=>{let t=this.BufferUtilsInstance.beepInterval(this.context,this.soundBuffer,e.start,e.end,this.lastArrayBuffer);this.lastStart=t.start,this.lastEnd=t.end,this.lastArrayBuffer=t.lastArrayBuffer,this.updateCurrentAudio(t.updatedBuffer,t.fileURL,this.mediaElement.currentTime,!1,!1)}))}fadeInSelection(){let e=this.getSelectedInterval();e&&(this.setLoading(!0),this.showCanvasSnapshot().then(()=>{let t=this.BufferUtilsInstance.fadeInInterval(this.context,this.soundBuffer,e.start,e.end,this.lastArrayBuffer);this.lastStart=t.start,this.lastEnd=t.end,this.lastArrayBuffer=t.lastArrayBuffer,this.updateCurrentAudio(t.updatedBuffer,t.fileURL,this.mediaElement.currentTime,!1,!1)}))}fadeOutSelection(){let e=this.getSelectedInterval();e&&(this.setLoading(!0),this.showCanvasSnapshot().then(()=>{let t=this.BufferUtilsInstance.fadeOutInterval(this.context,this.soundBuffer,e.start,e.end,this.lastArrayBuffer);this.lastStart=t.start,this.lastEnd=t.end,this.lastArrayBuffer=t.lastArrayBuffer,this.updateCurrentAudio(t.updatedBuffer,t.fileURL,this.mediaElement.currentTime,!1,!1)}))}changeVolumeSelection(){let e=this.getSelectedInterval();if(e){let t=0;if(0==this.volumeSliderValue)return void console.log("value could be different from zero");this.volumeSliderValue<0?t=1/(Math.abs(this.volumeSliderValue)+1):this.volumeSliderValue>0&&(t=1*(this.volumeSliderValue+1)),this.setLoading(!0),this.showCanvasSnapshot().then(()=>{let s=this.BufferUtilsInstance.changeVolumeInterval(this.context,this.soundBuffer,e.start,e.end,t,this.lastArrayBuffer);this.lastStart=s.start,this.lastEnd=s.end,this.lastArrayBuffer=s.lastArrayBuffer,this.updateCurrentAudio(s.updatedBuffer,s.fileURL,this.mediaElement.currentTime,!1,!1)})}}undo(){this.soundBufferSnapshots.length&&(this.setLoading(!0),this.showCanvasSnapshot().then(()=>{let e=this.soundBufferSnapshots.pop();this.lastStart=null,this.lastEnd=null,this.updateCurrentAudio(null,e.fileURL,e.time,!0,!1)}))}notifyChangeDuration(e){this.callbacks.change_duration&&this.callbacks.change_duration(e)}save(){this.callbacks.save&&this.callbacks.save({fileURL:this.mediaElement.src,buffer:this.HelperInstance.copyAudioBuffer(this.soundBuffer),time:this.mediaElement.currentTime})}on(e,t){this.callbacks[e]?this.UIHelperInstance.warning("callback: "+e+" is already registered"):this.callbacks[e]=t}}}]).default;